(()=>{"use strict";class t{constructor(t,e,s,i){this.x=t,this.y=e,this.id=s,this.speed=Math.random()/250*i,this.speedMultiplier=i,this.speed<.001*i&&(this.speed=.001*i);const h=Math.floor(6*Math.random())+6;this.height=h,this.width=.48802*h,this.brightness=!0}getCoordinates(){return[this.x,this.y]}getHeight(){return this.height}getWidth(){return this.width}getSpeed(){return this.speed}getShape(){return this.shape}getId(){return this.id}appendToHtml(t){this.html=document.createElement("div");const e=this.getCoordinates();this.html.className=this.getShape(),this.html.id=this.getId().toString(),this.html.style.left=`${e[0].toString()}vw`,this.html.style.top=`${e[1].toString()}vh`,this.html.style.width=`${this.width}vw`,this.html.style.height=`${this.height}vh`,this.html.style.zIndex=this.getId().toString(),t.appendChild(this.html)}swapBrightness(){if(!0===this.brightness)return this.brightness=!1,this.html.style.filter="brightness(70%)",void(this.html.style.opacity="50%");this.brightness=!0,this.html.style.filter="brightness(100%)",this.html.style.opacity="100%"}checkCollision(t){const e=t.getCoordinates();return!(e[0]+t.getWidth()<this.x||e[0]>this.x+this.width||e[1]+t.getHeight()<this.y||e[1]>this.y+this.height)}}var e,s;!function(t){t.Chaser="Chaser",t.Random="Random",t.Escape="Escape"}(e||(e={})),function(t){t.Circle="circle",t.Square="square",t.Triangle="triangle"}(s||(s={}));class i extends t{constructor(t,h,n,r){super(t,h,n,r),this.type=e.Chaser,this.shape=s.Triangle,i.chaserArray.push(this),this.speed*=6}static getChaserArray(){return i.chaserArray}revert(){this.x=this.oldX,this.y=this.oldY}stopSpinning(t){this.html.style.animation="",t.appendChild(this.html)}move(t,e){this.oldX=this.x,this.oldY=this.y,this.x+=this.speed*(this.x>t?-1:1),this.y+=this.speed*(this.y>e?-1:1),this.x>100-this.width?this.x=100-this.width:this.x<0&&(this.x=0),this.y>100-this.height?this.y=100-this.height:this.y<0&&(this.y=0);const s=i.getChaserArray();for(let t=0;t<s.length;t++)if(this.getId()!==s[t].getId()&&this.checkCollision(s[t]))return void this.revert()}onHitTarget(){return"Over"}}i.chaserArray=new Array;const h=i,n=class extends t{constructor(t,i,h,n){super(t,i,h,n),this.type=e.Escape,this.shape=s.Circle,this.speed*=.5,this.canGiveScore=!0,this.canMove=!0,this.evade=!0}move(t,e){this.canMove&&(this.x+=this.speed*(100-Math.abs(this.x-t)/2+1)*(this.x>t?1:-1),this.y+=this.speed*(100-Math.abs(this.y-e)/2+1)*(this.y>e?1:-1),this.x>100-this.width?this.x=100-this.width:this.x<0&&(this.x=0),this.y>100-this.height?this.y=100-this.height:this.y<0&&(this.y=0))}forceMove(){this.x+=this.pushX,this.y+=this.pushY,this.x>100-this.width?this.x=100-this.width:this.x<0&&(this.x=0),this.y>100-this.height?this.y=100-this.height:this.y<0&&(this.y=0)}push(t){if(100===t)return this.canMove=!0,this.canGiveScore=!0,this.html.style.opacity="100%",void(this.evade=!0);setTimeout((()=>{this.forceMove(),this.push(t+1)}),5)}onHitTarget(){return this.canGiveScore?(this.canGiveScore=!1,this.canMove=!1,this.html.style.opacity="30%",this.pushX=Math.random()/6*(Math.random()>.5?1:-1)*this.speedMultiplier,this.pushY=Math.random()/6*(Math.random()>.5?1:-1)*this.speedMultiplier,this.push(0),"Score"):(this.evade&&(this.evade=!1,setTimeout((()=>{this.evade=!0}),50),this.pushX*=1.5,this.pushY*=1.5),"")}},r=class extends t{constructor(t,i,h,n){super(t,i,h,n),this.type=e.Random,this.shape=s.Square,this.xPath=Math.random()*(Math.random()>.5?1:-1)*50,this.yPath=Math.random()*(Math.random()>.5?1:-1)*50}changePath(){for(this.xPath=Math.random()*(Math.random()>.5?1:-1)*80,this.yPath=Math.random()*(Math.random()>.5?1:-1)*80;Math.abs(this.xPath)+Math.abs(this.yPath)<40;)this.xPath=Math.random()*(Math.random()>.5?1:-1)*80,this.yPath=Math.random()*(Math.random()>.5?1:-1)*80}move(){this.x>100-this.width?(this.x=100-this.width,this.changePath()):this.x<0&&(this.changePath(),this.x=0,this.changePath()),this.y>100-this.height?(this.y=100-this.height,this.changePath()):this.y<0&&(this.y=0,this.changePath()),this.x+=this.xPath*this.speed,this.y+=this.yPath*this.speed}onHitTarget(){return"Over"}};class a{constructor(t,e,s,i){this.x=t,this.y=e,this.speed=s,this.cursor=i}getCoordinates(){return[this.x,this.y]}getSpeed(){return this.speed}move(t,e){if(this.cursor)return this.x=t-1.5,void(this.y=e-3);this.x+=(t-this.x)*this.speed/10+(t-this.x>0?1:-1)*this.speed,this.y+=(e-this.y)*this.speed/10+(e-this.y>0?1:-1)*this.speed,this.x>97?this.x=97:this.x<0&&(this.x=0),this.y>94?this.y=94:this.y<0&&(this.y=0)}checkCollision(t){const e=t.getCoordinates();if("triangle"!==t.getShape()){if(e[0]+t.getWidth()<this.x)return!1;if(e[0]>this.x+3)return!1;if(e[1]+t.getHeight()<this.y)return!1;if(e[1]>this.y+6)return!1}else{if(e[0]+.9*t.getWidth()<this.x)return!1;if(e[0]>this.x+2.92812*.9)return!1;if(e[1]+t.getHeight()<this.y)return!1;if(e[1]>this.y+4.5)return!1}return!0}}let d=document.getElementById("chaserValue"),o=document.getElementById("randomValue"),l=document.getElementById("escapeValue"),c=document.getElementById("randomEnemyValue"),m=document.getElementById("enemySpeedValue"),p=document.getElementById("playerSpeedValue");const y=document.getElementById("chaserRange"),u=document.getElementById("randomRange"),g=document.getElementById("escapeRange"),v=document.getElementById("randomEnemyRange"),M=document.getElementById("enemySpeedRange"),E=document.getElementById("playerSpeedRange");y.oninput=()=>{d.innerHTML=`Chasers: ${y.value}`},u.oninput=()=>{o.innerHTML=`Randoms: ${u.value}`},g.oninput=()=>{l.innerHTML=`Escapes: ${g.value}`},v.oninput=()=>{c.innerHTML=`Random enemies: ${v.value}`},M.oninput=()=>{m.innerHTML=`Enemy speed: ${M.value}%`},E.oninput=()=>{p.innerHTML=`Player speed: ${E.value}%`};const f=document.getElementById("follow"),I=document.getElementById("cursor");f.addEventListener("click",(()=>{!0===I.checked?(I.checked=!1,document.getElementById("playerSpeedSlider").style.display="initial"):f.checked=!0})),I.addEventListener("click",(()=>{!0===f.checked?(f.checked=!1,document.getElementById("playerSpeedSlider").style.display="none"):I.checked=!0}));const x=new class{setMouseCoordinates(t){this.mouseX=t.pageX/this.windowWidth*100,this.mouseY=t.pageY/this.windowHeight*100}constructor(){this.body=document.getElementById("canvas"),this.enemies=new Array,this.chasers=new Array,this.windowHeight=window.innerHeight,this.windowWidth=window.innerWidth,document.addEventListener("mousemove",this.setMouseCoordinates.bind(this))}cleanup(t){this.endMenu.remove(),this.playerDiv.remove(),this.scoreDiv.remove();for(const t of this.enemies)document.getElementById(t.getId().toString()).remove();for(;this.enemies.length>0;)this.enemies.pop();for(;this.chasers.length>0;)this.chasers.pop();this.body.style.filter="brightness(100%)",!0!==t?document.getElementById("difficultyPage").style.display="initial":this.startGame(this.startSetting[0],this.startSetting[1],this.startSetting[2],this.startSetting[3],this.startSetting[4],this.startSetting[5],1===this.startSetting[6])}endGame(){clearInterval(this.actionInterval),clearInterval(this.scoreInterval),this.endMenu=document.createElement("div"),this.endMenu.className="endMenu";const t=document.createElement("h1");t.innerHTML=`Ended game with score ${this.score}\n             Restart?`,this.endMenu.appendChild(t);const e=document.createElement("button");e.innerHTML="RESTART",e.addEventListener("click",this.cleanup.bind(this,!0)),this.endMenu.appendChild(e);const s=document.createElement("button");s.innerHTML="MENU",s.className="endMenuButton",s.addEventListener("click",this.cleanup.bind(this,!1)),this.endMenu.appendChild(s),this.score=0;for(const t of this.enemies)t.swapBrightness();this.body.style.filter="brightness(60%)",this.playerDiv.style.filter="brightness(70%)",this.playerDiv.style.opacity="50%";for(const t of this.chasers)t.stopSpinning(this.body);this.body.appendChild(this.endMenu)}redraw(){const t=this.player.getCoordinates();document.getElementById("0").style.left=`${t[0]}vw`,document.getElementById("0").style.top=`${t[1]}vh`;for(const t of this.enemies)document.getElementById(t.getId().toString()).style.left=`${t.getCoordinates()[0]}vw`,document.getElementById(t.getId().toString()).style.top=`${t.getCoordinates()[1]}vh`;this.scoreDiv.innerHTML=`${this.score}`}actionQueue(){const t=this.player.getCoordinates();void 0!==this.mouseX&&void 0!==this.mouseY&&this.player.move(this.mouseX,this.mouseY);for(const e of this.enemies){if(this.player.checkCollision(e)){const t=e.onHitTarget();if("Over"===t)return this.redraw(),void this.endGame();"Score"===t&&(this.score+=5)}"square"===e.getShape()?e.move():e.move(t[0],t[1])}this.redraw()}startGame(t,s,i,d,o,l,c){document.getElementById("difficultyPage").style.display="none",this.startSetting=[t,s,i,d,o,l,!0===c?1:0],this.score=0,this.scoreDiv=document.createElement("h1"),this.scoreDiv.className="score",this.scoreDiv.innerHTML=`${this.score}`,this.scoreDiv.style.zIndex="-1",this.body.appendChild(this.scoreDiv),this.player=new a(50,50,l/100*.06,c),this.playerDiv=document.createElement("div"),this.playerDiv.id="0",this.playerDiv.className="player",this.playerDiv.style.left="50vw",this.playerDiv.style.top="50vh",this.playerDiv.style.zIndex="2000000",this.body.appendChild(this.playerDiv),this.actionInterval=setInterval(this.actionQueue.bind(this),5),this.scoreInterval=setInterval((()=>{this.score++}),1e3);const m=new class{constructor(t){this.enemiesCreated=0,this.speedMultiplier=t/100}getRandomEnemy(){const t=Math.floor(3*Math.random());let e=88*Math.random(),s=88*Math.random();for(;e>35&&e<65&&s>35&&s<65;)e=88*Math.random(),s=88*Math.random();return 1===t?(this.enemiesCreated++,new h(e,s,this.enemiesCreated,this.speedMultiplier)):2===t?(this.enemiesCreated++,new n(e,s,this.enemiesCreated,this.speedMultiplier)):(this.enemiesCreated++,new r(e,s,this.enemiesCreated,this.speedMultiplier))}getSpecificEnemy(t){let s=88*Math.random(),i=88*Math.random();for(;s>35&&s<65&&i>35&&i<65;)s=88*Math.random(),i=88*Math.random();return this.enemiesCreated++,t===e.Chaser?new h(s,i,this.enemiesCreated,this.speedMultiplier):t===e.Escape?new n(s,i,this.enemiesCreated,this.speedMultiplier):t===e.Random?new r(s,i,this.enemiesCreated,this.speedMultiplier):void 0}getEnemiesCreated(){return this.enemiesCreated}}(o);for(let s=0;s<t;s++){let t=m.getSpecificEnemy(e.Chaser);t.appendToHtml(this.body),this.enemies.push(t),this.chasers.push(t)}for(let t=0;t<i;t++){let t=m.getSpecificEnemy(e.Escape);t.appendToHtml(this.body),this.enemies.push(t)}for(let t=0;t<s;t++){let t=m.getSpecificEnemy(e.Random);t.appendToHtml(this.body),this.enemies.push(t)}for(let t=0;t<d;t++){let t=m.getRandomEnemy();t.appendToHtml(this.body),this.enemies.push(t),"triangle"===t.getShape()&&this.chasers.push(t)}}};document.getElementById("startButton").addEventListener("click",(()=>{const t=parseInt(document.getElementById("chaserRange").value),e=parseInt(document.getElementById("randomRange").value),s=parseInt(document.getElementById("escapeRange").value),i=parseInt(document.getElementById("randomEnemyRange").value),h=parseInt(document.getElementById("enemySpeedRange").value),n=parseInt(document.getElementById("playerSpeedRange").value);x.startGame(t,e,s,i,h,n,I.checked)}))})();